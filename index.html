<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#0f172a">
  <title>Phase 10 โ Ultimate</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>

  <div class="background-animation"></div>

  <div class="container">
    
    <div id="loginScreen" class="glass-panel centered-panel">
        <div class="panel-header">
            <h1>PHASE 10 ๐</h1>
            <p>ุณุฌู ุฏุฎููู ูุง ุจุทู</p>
        </div>
        <div class="input-stack">
            <input id="loginEmail" type="email" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" dir="ltr">
            <input id="loginPass" type="password" placeholder="ูููุฉ ุงููุฑูุฑ" dir="ltr">
            <button id="doLoginBtn" class="btn-main">ุฏุฎูู ๐</button>
        </div>
        <div class="panel-footer">
            <span id="goToRegister">ููุณ ูุฏูู ุญุณุงุจุ <b>ุงูุดุฆ ุญุณุงุจ</b></span>
        </div>
    </div>

    <div id="registerScreen" class="glass-panel centered-panel" style="display:none;">
        <div class="panel-header">
            <h1>ุญุณุงุจ ุฌุฏูุฏ ๐</h1>
            <p>ุณุฌู ุนุดุงู ุฅุญุตุงุฆูุงุชู ุชุชุญูุธ!</p>
        </div>
        <div class="input-stack">
            <input id="regName" placeholder="ุงูุงุณู (ุงูููุจ)">
            <div class="avatar-selector">
                <label>ุงุฎุชุฑ ุงูุฃูุงุชุงุฑ:</label>
                <div id="avatarGrid" class="avatar-grid"></div>
                <input type="hidden" id="selectedAvatar" value="๐ค">
            </div>
            <input id="regEmail" type="email" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" dir="ltr">
            <input id="regPass" type="password" placeholder="ูููุฉ ุงููุฑูุฑ" dir="ltr">
            <button id="doRegisterBtn" class="btn-success">ุชุณุฌูู ุงูุญุณุงุจ โจ</button>
        </div>
        <div class="panel-footer">
            <span id="goToLogin">ูุฏูู ุญุณุงุจุ <b>ุฏุฎูู</b></span>
        </div>
    </div>

    <div id="lobbyScreen" class="screen-container" style="display:none;">
        <div class="top-bar">
            <div class="user-badge" id="openProfileBtn">
                <span id="userAvatarDisplay">๐ค</span>
                <span id="userNameDisplay">...</span>
            </div>
            <button id="logoutBtn" class="btn-icon">๐ช</button>
        </div>

        <div class="lobby-header">
            <h2 id="lobbyTitle">ุบุฑูุฉ ุงูุงูุชุธุงุฑ ๐๏ธ</h2>
            <p id="lobbySubtitle">ุฌุงุฑู ุงูุชุญููู...</p>
        </div>

        <div class="lobby-list-container">
            <div id="onlinePlayersList" class="lobby-list"></div>
        </div>

        <div id="adminLobbyControls" class="floating-admin-actions" style="display:none;">
            <div class="admin-actions-row">
                <button id="resetGameBtn" class="btn-secondary">๐ ุชุตููุฑ</button>
                <button id="startGameBtn" class="btn-main flex-grow">โฝ ุงุจุฏุฃ ุงููุจุงุฑุงุฉ</button>
            </div>
            <div class="admin-actions-row" style="margin-top:5px;">
                <button id="lobbyChangeAdminBtn" class="btn-glass flex-grow" style="color:var(--gold); border-color:var(--gold);">๐ ููู ุงูุฃุฏูู</button>
                <button id="syncPlayersBtn" class="btn-info flex-grow">๐ฅ ุงุณุชุฏุนุงุก ุงููู</button>
            </div>
            <div class="admin-actions-row" style="margin-top:5px;">
                <button id="factoryResetBtn" class="btn-danger-text flex-grow">โข๏ธ ูุณุญ ุดุงูู (ุฅุตูุงุญ)</button>
            </div>
        </div>
        
        <div class="shared-footer-actions">
             <button id="showFameBtn" class="btn-glass full-width" style="margin-top:10px;">๐ ุชุฑุชูุจ ุงูุฏูุฑู ุงูุนุงู</button>
        </div>
        
        <div id="playerWaitingMsg" style="text-align:center; margin-top:20px; display:none;">
            <div class="loader-spinner">โณ</div>
            <p id="waitingText">ูู ุงูุชุธุงุฑ ุจุฏุก ุงููุจุงุฑุงุฉ...</p>
        </div>
    </div>

    <div id="gameRoom" class="screen-container" style="display:none;">
      <div class="game-header-card">
          <div class="header-top">
              <div class="round-badge">
                  <span class="round-label">ุฌููุฉ</span>
                  <span id="roundNum" class="round-value">1</span>
              </div>
              <div class="header-actions">
                  <button id="viewFullTableBtn" class="btn-icon-glass">๐</button>
                  <div style="position:relative;">
                      <button id="adminBackToLobbyBtn" class="btn-icon-glass" style="display:none; background:rgba(251, 191, 36, 0.2); color:var(--gold);">๐</button>
                      <div id="adminNotificationDot" class="notification-dot" style="display:none;"></div>
                  </div>
                  <button id="waBtn" class="btn-icon-glass success-color">๐ฌ</button>
                  <button id="leaveGameBtn" class="btn-icon-glass danger-color">โ</button>
              </div>
          </div>
          <div class="round-description">
              <span id="roundDesc">-- ูุทููุจ --</span>
          </div>
          <div id="adminGameControls" class="admin-round-nav" style="display:none;">
              <button id="prevRoundBtn" class="nav-arrow">โฎ</button>
              <span style="font-size:12px; opacity:0.7">ุชุบููุฑ ุงูุฌููุฉ</span>
              <button id="nextRoundBtn" class="nav-arrow">โฏ</button>
          </div>
      </div>

      <div class="glass-panel" style="padding: 10px; margin-bottom: 15px;">
        <div class="row-btns">
          <button id="leaderBtn" class="btn-glass flex-grow">๐ ุงูุชุฑุชูุจ</button>
          <button id="randomSkipBtn" class="btn-glass flex-grow">๐ฒ ุนุดูุงุฆู</button>
          <button id="smartSkipBtn" class="btn-purple flex-grow">๐ง ุฐูู</button>
        </div>
      </div>

      <div id="myStatusCard" class="status-banner" style="display:none">
          <div id="statusEmoji" class="status-icon">๐ฆ</div>
          <div class="status-text">
              <h3 id="statusTitle">ุฃูุช ุงููุณูุทุฑ!</h3>
              <p id="statusMsg">...</p>
          </div>
      </div>

      <div id="cardsContainer" class="cards-list"></div>
      
      <div id="adminFinishControls" class="floating-bottom-actions" style="display:none;">
          <div class="row-btns">
            <button id="gameChangeAdminBtn" class="btn-glass" style="color:var(--gold); border-color:var(--gold);">๐ ุงูุฃุฏูู</button>
            <button id="finishGameBtn" class="btn-danger flex-grow">๐พ ุฅููุงุก ุงููุจุงุฑุงุฉ ูุญูุธ</button>
          </div>
      </div>
    </div>
  </div>

  <div id="fullTableModal" class="modal-overlay" style="display:none;">
      <div class="modal-content table-modal">
          <div class="modal-header">
              <h3>๐ ุงูุฌุฏูู ุงููุงูู</h3>
              <button id="closeFullTableBtn" class="close-icon">โ</button>
          </div>
          <div class="table-scroll"><table id="scoreTable"><thead><tr id="tHead"></tr></thead><tbody id="tBody"></tbody></table></div>
      </div>
  </div>

  <div id="profileModal" class="modal-overlay" style="display:none;">
      <div class="modal-content">
          <h3>ุชุนุฏูู ุงูููู</h3>
          <div class="input-stack">
              <input id="editName" placeholder="ุงูุงุณู">
              <div id="editAvatarGrid" class="avatar-grid small-grid"></div>
              <input type="hidden" id="editSelectedAvatar">
              <input id="editPass" type="password" placeholder="ุจุงุณููุฑุฏ ุฌุฏูุฏ (ุงุฎุชูุงุฑู)">
              <button id="saveProfileChangesBtn" class="btn-success">ุญูุธ</button>
          </div>
          <button id="closeProfileModalBtn" class="btn-text">ุฅูุบุงุก</button>
      </div>
  </div>

  <div id="fameModal" class="modal-overlay" style="display:none; z-index:9999;">
      <div class="modal-content table-modal">
          <div class="modal-header">
              <h3 style="color:var(--gold)">๐ ุชุฑุชูุจ ุงูุฏูุฑู ุงูุนุงู</h3>
              <button id="closeFameBtn" class="close-icon">โ</button>
          </div>
          <div id="fameList" class="fame-list"></div>
      </div>
  </div>

  <div id="adminSelectModal" class="modal-overlay" style="display:none;">
      <div class="modal-content">
          <h3>ุชุณููู ุงูููุงุฏุฉ ๐</h3>
          <div id="adminCandidatesList" class="list-selection"></div>
          <button id="closeAdminModalBtn" class="btn-text">ุฅูุบุงุก</button>
      </div>
  </div>

  <div id="subModal" class="modal-overlay" style="display:none;">
      <div class="modal-content">
          <h3>ุชุจุฏูู ุงููุงุนุจ ๐</h3>
          <h4 id="subTargetName" style="color:var(--gold)"></h4>
          <div id="benchList" class="list-selection"></div>
          <button id="closeSubModalBtn" class="btn-text">ุฅูุบุงุก</button>
      </div>
  </div>

  <div id="skipModal" class="modal-overlay" style="display:none;">
    <div class="modal-content text-center">
      <div style="font-size:50px">๐</div>
      <h4 id="skipType"></h4>
      <h2 id="skipTarget" style="color:var(--accent)"></h2>
      <button id="closeModalBtn" class="btn-main full-width">ุชูุงู</button>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <audio id="skipAudio" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3" preload="auto"></audio>
  <audio id="lionAudio" src="https://www.myinstants.com/media/sounds/lion-roar.mp3" preload="auto"></audio>
  <audio id="sheepAudio" src="https://www.myinstants.com/media/sounds/goat-scream.mp3" preload="auto"></audio>
  <audio id="winAudio" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3" preload="auto"></audio>

  <script src="script.js"></script>
</body>
</html>
